# Mapping Conditional Essentialities: A CRISPR Knockout Framework for Cancer Research

This repository contains code and resources for our **MED 263 (Winter 2025) final project**, in which we explore **multi-omics integration** for CRISPR-based gene essentiality analyses in cancer. We use **DepMap** data (Chronos effect, dependency probabilities, copy number, mutations, and expression) alongside cell-line metadata to:

1. Identify essential genes across various cancer cell lines.  
2. Explore how mutation, copy number, and expression influence CRISPR knockout phenotypes.  
3. Demonstrate how integrated bioinformatics pipelines can refine gene essentiality predictions.

The project focuses on **ARID1A** (a tumor suppressor) and **KRAS** (an oncogene) as illustrative examples of context-dependent essentialities.

---

## Table of Contents

1. [Repository Overview](#repository-overview)
2. [Project Slides](#project-slides) 
3. [Environment and Installation](#environment-and-installation)  
   - [Option A: Run via Google Colab](#option-a-run-via-google-colab)  
   - [Option B: Run Locally with Conda Environment](#option-b-run-locally-with-conda-environment)  
4. [Data Preparation](#data-preparation)  
5. [Directory Structure](#directory-structure)   
6. [References](#references)  
7. [Contact](#contact)  

---

## 1. Repository Overview

- **Jupyter Notebook**  
  The main tutorial notebook ([**`CRISPR-Knockout-Framework.ipynb`**](https://github.com/ChestnutKurisu/MED263_Final_Project_WI25/blob/main/CRISPR-Knockout-Framework.ipynb)) demonstrates:
  - How to load CRISPR effect scores, gene dependency data, copy number, mutations, and expression.
  - Exploratory Data Analysis (EDA) for **ARID1A** and **KRAS**.
  - Statistical tests (Mann–Whitney U, correlation analyses).
  - Random Forest and Multi-Output Regression modeling to predict gene dependencies from multi-omics + metadata.
  - Unsupervised clustering (PCA + KMeans) to group cell lines by omics profiles.

- **Data**  
  - **`DepMap-preprocessed/`**: Contains pre-filtered CSV files for CRISPR effect, CRISPR dependency, copy number, expression, and mutations (for 30 genes). These files are generated by the script in `preprocessing-pipeline/filter-preprocess-data.py`.
  - **`Model.csv`**: Metadata file for cell lines (lineage, primary disease, etc.).

- **Slides**  
  - **`latex-slides/`**: LaTeX source and figures for our final presentation slide deck.  
  - [**`presentation-slide-deck.pdf`**](https://github.com/ChestnutKurisu/MED263_Final_Project_WI25/blob/main/latex-slides/presentation-slide-deck.pdf): The compiled PDF for our presentation.

- **Preprocessing Script**  
  - [**`preprocessing-pipeline/filter-preprocess-data.py`**](https://github.com/ChestnutKurisu/MED263_Final_Project_WI25/blob/main/preprocessing-pipeline/filter-preprocess-data.py): Script to filter large DepMap files down to a curated set of genes and rename columns.  

---

## 2. Project Slides

- The **final presentation slides** ([`presentation-slide-deck.pdf`](https://github.com/ChestnutKurisu/MED263_Final_Project_WI25/blob/main/latex-slides/presentation-slide-deck.pdf)) can be found in `latex-slides/`.  
- These slides showcase:
  - Background on CRISPR-Cas9, DepMap, and multi-omics integration.
  - Key EDA figures (e.g., ARID1A effect histograms, KRAS lineage boxplots).
  - Statistical analyses, correlation plots, and random forest predictions.
  - Discussion of CRISPR clinical/translational context and future directions.

---

## 3. Environment and Installation

You have **two main ways** to run the notebook:

### Option A: Run via Google Colab

The quickest way is to use our **Google Colab notebook**, which requires **no local installation** beyond a Google account.

1. **Open the Colab link**: [**Mapping Conditional Essentialities: A CRISPR Knockout Framework**](https://drive.google.com/file/d/12B8lswKoV_u2tAzg_mTVrqM9VQvqinOg/view?usp=sharing)

2. **Copy to your Drive**:  
   - Click **“Open with Google Colaborary”** if prompted.  
   - You may want to **make a copy** of the notebook (`File > Save a copy in Drive`) so you can save your edits.

3. **Run Cells**:  
   - Execute the cells from top to bottom. Alternatively, use `Runtime > Run all` to run all cells at once. 
   - The notebook will clone this GitHub repo so that the CSV data files are accessible to your Colab session.

---

### Option B: Run Locally with Conda Environment

If you prefer a local setup (on your own machine/server):

1. **Clone the repository**:
   ```bash
   git clone https://github.com/ChestnutKurisu/MED263_Final_Project_WI25.git
   cd MED263_Final_Project_WI25
   ```

2. **Install Miniconda/Anaconda** (if not already available).  
   [Anaconda Download](https://www.anaconda.com/products/distribution)  
   or  
   [Miniconda Download](https://docs.conda.io/en/latest/miniconda.html)

3. **Create a conda environment**:
   ```bash
   conda create -n med263_env python=3.12 -y
   conda activate med263_env
   ```

4. **Install required packages**:  
   You can either install them one by one:
   ```bash
   conda install numpy==1.26.4 pandas==2.2.2 seaborn==0.13.2 matplotlib==3.10.0 \
                 scipy==1.13.1 scikit-learn==1.6.1
   ```
   or use `pip` inside your conda environment:
   ```bash
   pip install numpy==1.26.4 pandas==2.2.2 seaborn==0.13.2 matplotlib==3.10.0 \
               scipy==1.13.1 scikit-learn==1.6.1
   ```

5. **Verify Jupyter is installed**:
   ```bash
   conda install -c conda-forge jupyterlab
   ```
   or
   ```bash
   conda install notebook
   ```

6. **Launch Jupyter Notebook**:
   ```bash
   jupyter notebook
   ```
   - Open your web browser to the URL shown in terminal (usually `http://127.0.0.1:8888`).
   - Navigate to the **`.ipynb`** notebook and open it.

7. **Run the Notebook**:
   - Ensure that the data files under `DepMap-preprocessed/` are in the correct location.
   - Execute the cells in order. The environment should have all necessary dependencies to replicate the results.

---

## 4. Data Preparation

- We include a **pre-filtered subset** of DepMap files in `DepMap-preprocessed/`. These contain:
  - `CRISPRGeneEffect.csv`
  - `CRISPRGeneDependency.csv`
  - `OmicsCNGene.csv`
  - `OmicsSomaticMutationsMatrixDamaging.csv`
  - `OmicsExpressionProteinCodingGenesTPMLogp1.csv`
  - `Model.csv`  
  Each file is merged in the project notebook via the `ModelID` field.

- **Original DepMap data** is publicly available from:  
  - [DepMap Portal](https://depmap.org/portal/data_page/?tab=allData)  
  - [dbGaP Study: phs003444.v2.p1](https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs003444.v2.p1)

- If you wish to **reproduce the filtering** (e.g., specify a different gene set), use the script in:
  - `preprocessing-pipeline/filter-preprocess-data.py`
  - Update the gene list in the script as desired.

**Note**: By default, the main notebook in this repo already expects the CSVs in `DepMap-preprocessed/`. You do not need to run the preprocessing script again unless you want to customize the gene subset.

---

## 5. Directory Structure

Below is a high-level overview of this repository:

```
MED263_WI25_Final_Project/
├── DepMap-preprocessed/
│   ├── CRISPRGeneDependency.csv
│   ├── CRISPRGeneEffect.csv
│   ├── Gene.csv
│   ├── Model.csv
│   ├── OmicsCNGene.csv
│   ├── OmicsExpressionProteinCodingGenesTPMLogp1.csv
│   ├── OmicsExpressionProteinCodingGenesTPMLogp1Stranded.csv
│   └── OmicsSomaticMutationsMatrixDamaging.csv
├── latex-slides/
│   ├── figs/
│   │   ├── arid1a_correlation_matrix.png
│   │   ├── arid1a_effect_histogram.png
│   │   ├── ...
│   ├── presentation-slide-deck.pdf
│   ├── presentation-slide-deck.tex
│   └── project-outline/
│       └── ...
├── preprocessing-pipeline/
│   └── filter-preprocess-data.py
├── CRISPR-Knockout-Framework.ipynb  <- Main tutorial notebook
└── README.md   <- This file
```

---

## 6. References

1. **DepMap Data Portal**: [https://depmap.org/portal/](https://depmap.org/portal/)  
2. **CERES**: Meyers RM et al. (2017). *Computational correction of copy number effect improves specificity of CRISPR–Cas9 essentiality screens in cancer cells.* *Nature Genetics* 49, 1779–1784. DOI:[10.1038/ng.3984](https://doi.org/10.1038/ng.3984)  
3. **Chronos**: Dempster JM et al. (2021). *Chronos: a cell population dynamics model of CRISPR experiments that improves inference of gene fitness effects.* *Genome Biol* 22, 343. DOI:[10.1186/s13059-021-02540-7](https://doi.org/10.1186/s13059-021-02540-7)  
4. **OMIM**: *ARID1A (603024), KRAS (190070)*, [OMIM Database](https://omim.org/)  
6. Additional references can be found in the slides and notebook.

---

## 7. Contact

- **Authors**:  
  - Anika Thatavarthy  
  - Param Somane  
  - Andrii Dovhaniuk  
  - Elizabeth Murphy  

- **Course**: MED 263 (Winter 2025)

For any questions or issues, please feel free to open a GitHub issue.

Thank you for your interest in our CRISPR multi-omics integration tutorial!
